---
date-published: 
theme: 
lentgh:
difficulty: 
rating: 
---

### What i learned
----

##### API calls without import table
1) Get the PEB address
2) In PEB -> Ldr -> InMemoryOrderModuleList find kernel32.dll or ntdll.dll
3) Walk through export table of dlls to find [[LoadLibraryA]] and [[GetProcAddress]](kernel32.dll) or LdrLoadDll and LdrGetProcedureAddress (ntdll.dll)
4) Use [[LoadLibraryA]] to load needed DLL
5) Use [[GetProcAddress]] to retrieve a needed function

The TEB is pointed to by a segment register. On 32-bit its FS on 64-bit its GS.
On 32-bit offset from TEB to PEB is 0x30, and on 64-bit offset is 0x60.


#TODO 